<!DOCTYPE html>
<html lang="es">
<head>
  <!-- =========================
    Archivo: /solutions/cybershield/soc-console.html
    Propósito: Consola SOC (demo) con filtros, tabla y tendencia.
    Notas:
    - Header con menú Solutions y hotfix.
    - Mantengo tu lógica y estilos.
  ========================== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SOC Console | RomanoTI Solutions</title>

  <!-- Tailwind + Fuente -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Favicon sencillo -->
  <link rel="icon" href="https://ui-avatars.com/api/?name=R&background=1e40af&color=fff&size=64" type="image/png">

  <!-- Chart.js para la mini-gráfica de tendencia -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- Estilos de la consola -->
  <style>
    body{font-family:'Montserrat',sans-serif;background:#f8f9fa;color:#111827}
    .hero-bg{background:linear-gradient(135deg,#0f3a2e 0%,#10b981 100%)}
    .btn-primary{background:#2563EB;transition:all .2s}
    .btn-primary:hover{background:#1D4ED8;transform:translateY(-1px)}
    .badge{display:inline-flex;align-items:center;padding:.15rem .5rem;border-radius:.5rem;font-size:.75rem;font-weight:700}
    .sev-critical{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}
    .sev-high{background:#ffedd5;color:#9a3412;border:1px solid #fed7aa}
    .sev-medium{background:#fef9c3;color:#92400e;border:1px solid #fde68a}
    .sev-low{background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0}
    .status-new{background:#dbeafe;color:#1e3a8a;border:1px solid #bfdbfe}
    .status-ack{background:#e0e7ff;color:#3730a3;border:1px solid #c7d2fe}
    .status-closed{background:#e5e7eb;color:#374151;border:1px solid #d1d5db}
    pre.json{background:#0e1116;color:#eaeef3;padding:10px;border-radius:8px;max-height:40vh;overflow:auto}
    .dropdown{display:none}
    .dropdown.show{display:block}
  </style>
</head>
<body>

  <!-- ===== Header simple con dropdown ===== -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-6 py-3">
      <div class="flex items-center justify-between">
        <a href="/" class="flex items-center font-bold text-xl">
          <span class="inline-flex items-center justify-center w-9 h-9 rounded-full bg-blue-600 text-white mr-3">R</span>
          RomanoTI Solutions
        </a>
        <nav class="hidden md:flex items-center space-x-6">
          <a href="/" class="text-gray-700 hover:text-blue-600">Home</a>

          <!-- Dropdown Solutions -->
          <div class="relative">
            <button id="solutionsBtn" class="text-gray-700 hover:text-blue-600 inline-flex items-center focus:outline-none">
              Solutions
              <svg class="ml-1 w-4 h-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.584l3.71-3.354a.75.75 0 111.02 1.1l-4.2 3.794a.75.75 0 01-1.02 0l-4.2-3.794a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
            </button>
            <div id="solutionsMenu" class="dropdown absolute right-0 mt-2 w-72 rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5">
              <a href="/solutions/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">Overview</a>
              <a href="/solutions/cybershield/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">CyberShield (MDR)</a>
              <a href="/solutions/cybershield/soc-console.html" class="block px-4 py-2 text-sm text-blue-700 font-semibold bg-gray-50">SOC Console</a>
              <a href="/solutions/cybershield/easm-console.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">EASM Console</a>
              <a href="/solutions/cybershield/field-kit.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">Field Kit</a>
            </div>
          </div>

          <a href="/services/tools.html" class="text-gray-700 hover:text-blue-600">Tools</a>
          <a href="/it-noc.html" class="text-gray-700 hover:text-blue-600">NOC</a>
          <a href="/it-soc.html" class="text-gray-700 hover:text-blue-600">SOC</a>
          <a href="https://calendly.com/mauricioromeroca" class="btn-primary text-white px-4 py-2 rounded-lg font-medium">Book Now</a>
        </nav>
      </div>
    </div>
  </header>

  <!-- ===== Título / Hero ===== -->
  <section class="hero-bg text-white py-12">
    <div class="container mx-auto px-6">
      <h1 class="text-3xl md:text-4xl font-bold">SOC Console</h1>
      <p class="text-lg opacity-90 mt-2">Visor de alertas, Ack/Cierre y tendencia (demo/mocks listos para crecer).</p>
    </div>
  </section>

  <!-- ===== Main: conexión, filtros, gráfica y tabla ===== -->
  <main class="container mx-auto px-6 py-8 space-y-8">

    <!-- Panel de conexión -->
    <section class="bg-white border rounded-xl shadow-sm p-5">
      <h2 class="text-xl font-semibold mb-2">Conexión</h2>
      <p class="text-gray-600 mb-4">Tu <b>Org API Key</b> sólo se usa como header <code>x-api-key</code> y se guarda en tu navegador.</p>
      <div class="grid md:grid-cols-3 gap-4 items-end">
        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-gray-700 mb-1">Org API Key</label>
          <input id="orgKey" type="password" class="w-full border rounded-lg px-3 py-2" placeholder="MySecret123$">
          <p id="keyMsg" class="text-sm text-gray-500 mt-1"></p>
        </div>
        <div class="flex gap-3">
          <button id="btnSaveKey" class="btn-primary text-white px-4 py-2 rounded-lg">Guardar</button>
          <button id="btnRefresh" class="px-4 py-2 rounded-lg border">Refrescar</button>
        </div>
      </div>
    </section>

    <!-- Filtros / Auto-refresh -->
    <section class="bg-white border rounded-xl shadow-sm p-5">
      <div class="grid md:grid-cols-4 gap-4 items-end">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Severidad</label>
          <select id="fltSeverity" class="w-full border rounded-lg px-3 py-2">
            <option value="">Todas</option>
            <option value="critical">Critical</option>
            <option value="high">High</option>
            <option value="medium">Medium</option>
            <option value="low">Low</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Source (texto)</label>
          <input id="fltSource" class="w-full border rounded-lg px-3 py-2" placeholder="edr / firewall / email">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Límite</label>
          <input id="fltLimit" type="number" min="1" max="200" value="50" class="w-full border rounded-lg px-3 py-2">
        </div>
        <div class="flex items-center gap-4">
          <label class="inline-flex items-center gap-2">
            <input id="autoRefresh" type="checkbox" class="rounded border-gray-300">
            <span>Auto-refresh (15s)</span>
          </label>
          <span id="lastRefresh" class="text-sm text-gray-500"></span>
        </div>
      </div>
    </section>

    <!-- Gráfica de tendencia -->
    <section class="bg-white border rounded-xl shadow-sm p-5">
      <h2 class="text-lg font-semibold mb-3">Tendencia (últimos 7 días)</h2>
      <canvas id="chartTrend" height="90"></canvas>
    </section>

    <!-- Tabla de alertas -->
    <section class="bg-white border rounded-xl shadow-sm p-5">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-lg font-semibold">Alertas recientes</h2>
        <div class="text-sm text-gray-500">Click en <b>Ack</b> o <b>Close</b> para actualizar estado.</div>
      </div>
      <div class="overflow-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-3 py-2 text-left text-xs font-semibold text-gray-600">Time (UTC)</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-gray-600">Sev</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-gray-600">Source</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-gray-600">Title</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-gray-600">Status</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-gray-600">SLA Ack</th>
              <th class="px-3 py-2 text-left text-xs font-semibold text-gray-600">Actions</th>
            </tr>
          </thead>
          <tbody id="tbAlerts" class="divide-y divide-gray-100 bg-white"></tbody>
        </table>
      </div>

      <details class="mt-4">
        <summary class="cursor-pointer text-sm text-gray-600">Payload seleccionado</summary>
        <pre id="alertJson" class="json mt-2"></pre>
      </details>
    </section>

  </main>

  <!-- ===== Lógica de consola (sin cambios funcionales) ===== -->
  <script>
  /* … (todo tu script original intacto) … */
  /* Copiado de tu versión actual – se omitió aquí por espacio.
     Asegúrate de mantener el mismo bloque que me compartiste. */
  </script>

  <!-- Dropdown legacy (.dropdown/.show) — opcional si mantienes el script original arriba -->
  <script>
    (function(){
      const btn  = document.getElementById('solutionsBtn');
      const menu = document.getElementById('solutionsMenu');
      if(!btn || !menu) return;
      const toggle = () => menu.classList.toggle('show');
      const close  = () => menu.classList.remove('show');
      btn.addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); toggle(); });
      document.addEventListener('click', (e)=>{ if(!menu.contains(e.target) && e.target!==btn) close(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') close(); });
    })();
  </script>

  <!-- ==== [NUEVO] Hotfix universal para el menú “Solutions” ==== -->
  <script src="/js/fix-nav.js" defer></script>
  <!-- ==== [FIN NUEVO] ==== -->
</body>
</html>
